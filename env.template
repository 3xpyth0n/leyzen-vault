# ==================================================================================
# Leyzen Vault - Environment Configuration Template
# ==================================================================================
#
# This is the template for your Leyzen Vault environment variables.
# Before running the project, rename this file to ".env" in the project root:
# 
#   cp env.template .env
#
# This file is consumed by Docker Compose services and helper scripts.
# DO NOT commit your actual ".env" file with real secrets to version control.
# Only commit this template (env.template) without secrets. Populate sensitive
# values exclusively in your private ".env" copy and rotate them routinely.
#
# ==================================================================================
# Naming Convention
# ==================================================================================
#
# Environment variables follow a standardized naming convention:
#
# - VAULT_*          : Variables specific to Leyzen Vault core functionality
#                      (e.g., VAULT_USER, VAULT_ROTATION_INTERVAL, VAULT_CSP_REPORT_MAX_SIZE)
# - DOCKER_*         : Variables for Docker/Docker Proxy configuration
#                      (e.g., DOCKER_PROXY_URL, DOCKER_PROXY_TOKEN, DOCKER_SOCKET_PATH)
# - FILEBROWSER_*    : Variables specific to the Filebrowser plugin
#                      (e.g., FILEBROWSER_VERSION, FILEBROWSER_ADMIN_USER)
# - PAPERLESS_*      : Variables specific to the Paperless plugin
#                      (e.g., PAPERLESS_DBPASS, PAPERLESS_SECRET_KEY)
# - LEYZEN_*         : Variables for Leyzen Vault infrastructure/tooling
#                      (e.g., LEYZEN_ENV_FILE)
#
# ==================================================================================
# Configuration Index
# ==================================================================================
#
# Quick reference by category. See inline comments below for detailed descriptions.
#
# Core: VAULT_TIMEZONE
# Authentication & Security: VAULT_USER (REQUIRED), VAULT_PASS, VAULT_SECRET_KEY (â‰¥12 chars),
#                            VAULT_PROXY_TRUST_COUNT, VAULT_SESSION_COOKIE_SECURE
# Advanced Security: VAULT_CAPTCHA_*, VAULT_LOGIN_CSRF_TTL_SECONDS
# Orchestrator: VAULT_SERVICE, VAULT_WEB_REPLICAS, VAULT_ROTATION_INTERVAL,
#               VAULT_WEB_CONTAINERS, VAULT_WEB_PORT, VAULT_WEB_HEALTHCHECK_*
# Advanced Orchestrator: VAULT_ORCHESTRATOR_PORT, VAULT_ORCHESTRATOR_LOG_*,
#                        VAULT_ORCHESTRATOR_SSE_INTERVAL_MS
# HAProxy HTTPS: VAULT_HTTP_PORT, VAULT_HTTPS_PORT, VAULT_ENABLE_HTTPS,
#                VAULT_SSL_CERT_PATH, VAULT_SSL_KEY_PATH
# Docker Proxy: DOCKER_PROXY_URL (optional), DOCKER_PROXY_TOKEN (â‰¥12 chars),
#               DOCKER_PROXY_LOG_LEVEL, DOCKER_PROXY_TIMEOUT
# CSP: VAULT_CSP_REPORT_MAX_SIZE, VAULT_CSP_REPORT_RATE_LIMIT
# Plugin-specific: FILEBROWSER_*, PAPERLESS_* (see plugin sections below)

# ==================================================================================
# Common Mistakes & Troubleshooting
# ==================================================================================
#
# âŒ DO NOT:
#   - Use default "admin" for VAULT_USER in production (insecure)
#   - Set VAULT_SECRET_KEY or DOCKER_PROXY_TOKEN shorter than 12 characters
#   - Forget to set VAULT_WEB_REPLICAS (minimum enforced by plugin, typically 2)
#   - Commit your .env file with real secrets to version control
#   - Use the same secret values across multiple deployments
#
# âœ… DO:
#   - Generate strong secrets: `openssl rand -hex 32` (generates 64-char hex string)
#   - Set VAULT_USER to a non-default value before first deployment
#   - Set VAULT_WEB_REPLICAS explicitly (e.g., VAULT_WEB_REPLICAS=3)
#   - Use ./leyzenctl config validate to check your configuration
#   - Rotate secrets periodically following SECURITY.md procedures
#
# ðŸ” Troubleshooting:
#   - "VAULT_USER is required": Set a non-empty value in .env
#   - "Secret must be at least 12 characters": Generate longer secrets (see above)
#   - "Plugin requires minimum X replicas": Set VAULT_WEB_REPLICAS â‰¥ plugin minimum
#   - "Container rotation failing": Check DOCKER_PROXY_TOKEN and docker-proxy service health
#
# Filebrowser Plugin:
#   - FILEBROWSER_VERSION          Release tag (without "v" prefix)
#   - FILEBROWSER_ADMIN_USER      Administrator username
#   - FILEBROWSER_ADMIN_PASSWORD  Administrator password
#
# Paperless Plugin (requires VAULT_SERVICE=paperless):
#   - PAPERLESS_DBPASS            Postgres database password
#   - PAPERLESS_SECRET_KEY        Cryptographic signing key
#   - PAPERLESS_URL               External URL for web interface
#   - PAPERLESS_IMAGE             Docker image override (advanced)
#   - PAPERLESS_POSTGRES_IMAGE    Postgres image override (advanced)
#   - PAPERLESS_REDIS_IMAGE       Redis image override (advanced)
#
# Development & Debugging:
#   - LEYZEN_ENV_FILE             Override .env file location
#   - PYTHONPATH                  Additional Python module paths
#
# ==================================================================================
# Core Configuration
# ==================================================================================

# Set your local time zone (default: UTC). Adjust this only in your local ".env" file.
VAULT_TIMEZONE=UTC

# ==================================================================================
# Authentication & Security
# ==================================================================================

# Username for accessing the Orchestrator dashboard.
# Example placeholder: admin (do not keep in production).
VAULT_USER=

# Password for the Orchestrator dashboard.
# Set a long, random value in your local ".env" file only.
VAULT_PASS=

# Secret key used by Flask for sessions and encryption.
# Replace with a long random string. Keep it secret (generate with
# `openssl rand -hex 32`) and never store it in Git history.
VAULT_SECRET_KEY=

# Number of proxies in front of the orchestrator whose headers should be
# trusted for client IP / protocol detection. Keep to 1 for the bundled
# HAProxy, set to 0 when no proxy is involved.
VAULT_PROXY_TRUST_COUNT=1

# Flag session cookies as Secure when TLS terminates in front of the orchestrator.
# Leave enabled for production deployments that serve the dashboard over HTTPS.
VAULT_SESSION_COOKIE_SECURE=true

# âš ï¸ Advanced: CAPTCHA image dimensions and text length for login verification.
# Uncomment only to customize the default CAPTCHA appearance.
# VAULT_CAPTCHA_IMAGE_WIDTH=220
# VAULT_CAPTCHA_IMAGE_HEIGHT=70
# VAULT_CAPTCHA_LENGTH=6

# âš ï¸ Advanced: TTL (seconds) for CAPTCHA store entries and login CSRF tokens.
# Uncomment only to customize the default TTL values.
# VAULT_CAPTCHA_STORE_TTL_SECONDS=300
# VAULT_LOGIN_CSRF_TTL_SECONDS=900

# ==================================================================================
# Orchestrator Configuration
# ==================================================================================

# Select the active service plugin (filebrowser, paperless, or custom plugins).
# Defaults to "filebrowser" when unset.
VAULT_SERVICE=filebrowser

# Number of front-end replicas to provision for the selected service plugin.
# Values lower than the plugin's minimum will be clamped automatically.
# Set to at least 2 for proper rotation behaviour.
#
# Plugin-specific defaults:
# - filebrowser: 3 replicas (min: 2)
# - paperless: 3 replicas (min: 2)
VAULT_WEB_REPLICAS=3

# Interval (in seconds) between backend rotations in the orchestrator.
# Increase for less frequent rotations or decrease for faster MTD behavior.
VAULT_ROTATION_INTERVAL=120

# Optional override for the plugin's internal HTTP port. Leave empty to use the 
# plugin-provided value (defaults to 80 for most plugins).
# VAULT_WEB_PORT=

# Optional HAProxy health-check customisation for non-standard services. The    
# path defaults to "/" and must be absolute. The host defaults to "localhost";  
# override it when the backend enforces a strict Host allowlist.
# Default values: VAULT_WEB_HEALTHCHECK_PATH="/", VAULT_WEB_HEALTHCHECK_HOST="localhost"
# VAULT_WEB_HEALTHCHECK_PATH=
# VAULT_WEB_HEALTHCHECK_HOST=

# Comma-separated list of Docker containers to rotate.
# REQUIRED: docker-proxy service requires this variable to be set at startup.
# If left unset, the orchestrator can derive the list from the selected plugin
# (e.g., filebrowser_web1, filebrowser_web2, filebrowser_web3 for filebrowser plugin),
# but docker-proxy will fail to start without it.
# RECOMMENDATION: Always set this variable explicitly for consistency and to avoid startup failures.
# Example: VAULT_WEB_CONTAINERS=filebrowser_web1,filebrowser_web2,filebrowser_web3
# VAULT_WEB_CONTAINERS=

# âš ï¸ Advanced: Override directory for orchestrator log files.
# VAULT_ORCHESTRATOR_LOG_DIR sets the directory where log files are stored.
# If not set, defaults to ./orchestrator/logs in the container.
# VAULT_ORCHESTRATOR_LOG_DIR=

# âš ï¸ Advanced: Override log filename.
# VAULT_ORCHESTRATOR_LOG_FILE sets the name of the log file within the log directory.
# If not set, defaults to "orchestrator.log".
# Example: If LOG_DIR=/app/logs and LOG_FILE=myapp.log, logs are written to /app/logs/myapp.log
# VAULT_ORCHESTRATOR_LOG_FILE=

# Server-Sent Events (SSE) stream interval in milliseconds. Controls how often
# telemetry updates are pushed to connected dashboard clients. Minimum: 50ms.
# VAULT_ORCHESTRATOR_SSE_INTERVAL_MS=

# ==================================================================================
# HAProxy HTTPS Configuration
# ==================================================================================

# Host port for HTTP traffic (container port 80). HAProxy will listen on this
# port on the host and forward to port 80 inside the container.
# Defaults to 8080 if not set. Must be between 1 and 65535.
# Example: VAULT_HTTP_PORT=80 (to use standard HTTP port)
# Example: VAULT_HTTP_PORT=8080 (default)
# VAULT_HTTP_PORT=

# Host port for HTTPS traffic (container port 443). HAProxy will listen on this
# port on the host and forward to port 443 inside the container.
# Only used when VAULT_ENABLE_HTTPS=true. Defaults to 8443 if not set.
# Must be between 1 and 65535.
# Example: VAULT_HTTPS_PORT=443 (to use standard HTTPS port)
# Example: VAULT_HTTPS_PORT=8443 (default)
# VAULT_HTTPS_PORT=

# Enable HTTPS/SSL support for HAProxy. When enabled, HAProxy will listen on
# port 443 (mapped to configured host port, default 8443) in addition to port 80
# (mapped to configured host port, default 8080).
# Requires valid SSL certificate files to be provided.
# Set to "true", "1", "yes", or "on" to enable HTTPS. Defaults to disabled.
# VAULT_ENABLE_HTTPS=false

# Path to SSL certificate file (PEM format). Can be absolute or relative to
# the repository root. The certificate file can contain both the certificate
# and private key in a single PEM file, or just the certificate if VAULT_SSL_KEY_PATH
# is also provided.
# REQUIRED if VAULT_ENABLE_HTTPS=true.
# Example: VAULT_SSL_CERT_PATH=/path/to/cert.pem
# Example: VAULT_SSL_CERT_PATH=./certs/domain.crt
# VAULT_SSL_CERT_PATH=

# Path to SSL private key file (PEM format). Can be absolute or relative to
# the repository root. Only required if the certificate and key are in separate
# files. If omitted, HAProxy will use the certificate file which should contain
# both cert and key in combined PEM format.
# OPTIONAL if VAULT_ENABLE_HTTPS=true (only needed if cert and key are separate).
# Example: VAULT_SSL_KEY_PATH=/path/to/key.pem
# Example: VAULT_SSL_KEY_PATH=./certs/domain.key
# VAULT_SSL_KEY_PATH=

# Notes:
# - Certificate files must exist and be readable when HTTPS is enabled.
# - The build script will validate certificate paths and warn if files are missing.
# - Ports can be customized via VAULT_HTTP_PORT and VAULT_HTTPS_PORT variables.
#   Defaults are 8080 for HTTP and 8443 for HTTPS to avoid conflicts with standard ports.
# - To use standard ports (80/443), set VAULT_HTTP_PORT=80 and VAULT_HTTPS_PORT=443.
#   Note: Using ports below 1024 may require root privileges or proper capabilities.
# - Both HTTP and HTTPS ports are exposed when HTTPS is enabled.
# - Backend services continue to communicate internally over HTTP (TLS termination
#   happens at HAProxy).
# - For production deployments, ensure certificates are valid and not expired.
# - Keep private keys secure and never commit them to version control.

# ==================================================================================
# Docker Proxy Configuration
# ==================================================================================

# Optional - defaults to: http://docker-proxy:2375
# Base URL for the secured Docker proxy that mediates container lifecycle actions.
# Only override if you are using a custom docker-proxy location.
DOCKER_PROXY_URL=http://docker-proxy:2375

# Access token injected in the Authorization header for every docker-proxy request.
# Rotate this secret regularly and keep it out of version control.
# You can generate a key with `openssl rand -hex 32`.
DOCKER_PROXY_TOKEN=

# Optional log level for the docker proxy (DEBUG, INFO, WARNING, ERROR).
DOCKER_PROXY_LOG_LEVEL=INFO

# Optional timeout (seconds) for individual Docker API calls proxied to the host
# by the docker-proxy service. Defaults to 30 seconds if unset.
# DOCKER_PROXY_TIMEOUT=

# Optional Docker socket path override for the docker-proxy service.
# This is an advanced setting that should only be changed if you need to use
# a non-standard Docker socket location. Defaults to /var/run/docker.sock.
# DOCKER_SOCKET_PATH=

# ==================================================================================
# Content Security Policy (CSP)
# ==================================================================================

# Maximum allowed size (bytes) for incoming CSP violation reports.
# Requests exceeding this limit are rejected with HTTP 413 before reading the body.
VAULT_CSP_REPORT_MAX_SIZE=4096

# Maximum number of CSP reports accepted per client IP in a 60-second rolling window.
# Additional requests are rejected with HTTP 429 (Too Many Requests).
VAULT_CSP_REPORT_RATE_LIMIT=5

# ==================================================================================
# Filebrowser Plugin Configuration
# ==================================================================================

# Desired Filebrowser release tag (without the leading "v").
# Defaults to 2.44.2 if left empty.
FILEBROWSER_VERSION=

# Primary Filebrowser administrator username.
# Use a unique value, rotate it periodically, and never commit it to source control.
FILEBROWSER_ADMIN_USER=

# Primary Filebrowser administrator password.
# Must be strong (long, random) and rotated on a regular schedule.
FILEBROWSER_ADMIN_PASSWORD=

# Each Filebrowser container mounts three shared Docker volumes declared in
# docker-compose.yml to persist uploads, user metadata, and app settings:
# - filebrowser-data:/srv          -> user-uploaded files
# - filebrowser-database:/database -> Filebrowser user database and auth state
# - filebrowser-config:/config     -> instance configuration and branding assets

# ==================================================================================
# Paperless Plugin Configuration
# ==================================================================================
# Note: These variables are only required when VAULT_SERVICE=paperless

# Database password for the embedded Postgres instance.
PAPERLESS_DBPASS=

# Secret key used by Paperless for cryptographic signing.
PAPERLESS_SECRET_KEY=

# External URL for the Paperless web interface. Adjust when reverse proxying.
PAPERLESS_URL=http://localhost:8080

# Optional Docker image tags for Paperless components. Leave empty to use defaults:
# - PAPERLESS_IMAGE: ghcr.io/paperless-ngx/paperless-ngx:latest
# - PAPERLESS_POSTGRES_IMAGE: postgres:15-alpine
# - PAPERLESS_REDIS_IMAGE: redis:7-alpine
# PAPERLESS_IMAGE=
# PAPERLESS_POSTGRES_IMAGE=
# PAPERLESS_REDIS_IMAGE=

# ==================================================================================
# Development & Debugging
# ==================================================================================

# Override the default .env file location for configuration.
# When set, this variable overrides the default `.env` file path used by        
# the orchestrator, docker-proxy, and compose/build.py scripts.
# Useful for multiple environments, CI/CD pipelines, or testing scenarios.      
# Can be an absolute path or relative to the project root directory.
# IMPORTANT: If using a relative path, it must be relative to the project root
# where docker-compose.yml and the build scripts are located.
# Example: LEYZEN_ENV_FILE=/path/to/custom.env
# Example: LEYZEN_ENV_FILE=config/production.env
# If unset, defaults to `.env` in the project root directory.
# LEYZEN_ENV_FILE=

# Custom PYTHONPATH entries (colon-separated) for module resolution in containers.
# Additional Python module search paths for the orchestrator container.
# Defaults include: /app, /vault_plugins, /common
# PYTHONPATH=

# ==================================================================================
# Notes
# ==================================================================================
# - Always keep secrets (passwords, keys) out of version control.
# - Use strong, unique passwords for production.
# - Ensure this file is readable by the user running the Docker Compose.
